services:
  graduacao:
    build:
      context: ..
      dockerfile: servicos/graduacao/Dockerfile
    restart: unless-stopped
    environment:
      PGR_POSTGRES_HOST: postgres
      PGR_POSTGRES_PORT: 5432
      PGR_POSTGRES_DB: ${POSTGRES_DB:-tccdb}
      PGR_POSTGRES_USER: ${POSTGRES_USER:-tcc}
      PGR_POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-tcc123}
      PGR_DEFAULT_SCHEMA: ${GRADUACAO_DEFAULT_SCHEMA:-public}
    ports:
      - "${GRADUACAO_PORT:-8081}:8081"
    depends_on:
      postgres:
        condition: service_healthy
    networks:
      - tcc-network

  pos-graduacao:
    build:
      context: ..
      dockerfile: servicos/pos-graduacao/Dockerfile
    restart: unless-stopped
    environment:
      PGR_POSTGRES_HOST: postgres
      PGR_POSTGRES_PORT: 5432
      PGR_POSTGRES_DB: ${POSTGRES_DB:-tccdb}
      PGR_POSTGRES_USER: ${POSTGRES_USER:-tcc}
      PGR_POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-tcc123}
      PGR_DEFAULT_SCHEMA: ${POS_GRADUACAO_DEFAULT_SCHEMA:-public}
    ports:
      - "${POS_GRADUACAO_PORT:-8082}:8082"
    depends_on:
      postgres:
        condition: service_healthy
    networks:
      - tcc-network

  diplomas:
    build:
      context: ..
      dockerfile: servicos/diplomas/Dockerfile
    restart: unless-stopped
    environment:
      PGR_POSTGRES_HOST: postgres
      PGR_POSTGRES_PORT: 5432
      PGR_POSTGRES_DB: ${POSTGRES_DB:-tccdb}
      PGR_POSTGRES_USER: ${POSTGRES_USER:-tcc}
      PGR_POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-tcc123}
      PGR_DEFAULT_SCHEMA: ${DIPLOMAS_DEFAULT_SCHEMA:-public}
    ports:
      - "${DIPLOMAS_PORT:-8083}:8083"
    depends_on:
      postgres:
        condition: service_healthy
    networks:
      - tcc-network

  assinatura:
    build:
      context: ..
      dockerfile: servicos/assinatura/Dockerfile
    restart: unless-stopped
    environment:
      PGR_POSTGRES_HOST: postgres
      PGR_POSTGRES_PORT: 5432
      PGR_POSTGRES_DB: ${POSTGRES_DB:-tccdb}
      PGR_POSTGRES_USER: ${POSTGRES_USER:-tcc}
      PGR_POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-tcc123}
      PGR_DEFAULT_SCHEMA: ${ASSINATURA_DEFAULT_SCHEMA:-public}
    ports:
      - "${ASSINATURA_PORT:-8084}:8084"
    depends_on:
      postgres:
        condition: service_healthy
    networks:
      - tcc-network
